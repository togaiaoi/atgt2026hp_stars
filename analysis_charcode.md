# 文字コード解析メモ

## 状況
stars.txtのSKIプログラムを評価すると、I/Oプロトコルで質問文を出力→鍵文字列を入力→正誤判定を行う。
文字列の取り出しに成功し、各文字のコード（整数値）を取得できた。
しかし、このコード(1-24)がどの文字に対応するか不明。

## I/Oフロー（確認済み）
1. 出力(文字列): 33文字の質問文
2. 入力(文字列): 鍵文字列の入力要求
3. 出力(文字列): 5文字のメッセージ（空入力→「間違い」的なもの）
4. 停止

## 取得した文字コード

### 質問文（33文字、読み順）
```
2, 8, 16, 5, 6, 20, 6, 19, 8, 22, 8, 19, 22, 21, 8, 24, 22, 23, 8, 19, 17, 1, 8, 7, 5, 17, 1, 22, 5, 8, 19, 6, 13
```

### エラーメッセージ（5文字、読み順）
```
19, 20, 22, 9, 21
```

## 観察

### 使われている値
- 質問文の固有値: {1, 2, 5, 6, 7, 8, 13, 16, 17, 19, 20, 21, 22, 23, 24} (15種類)
- エラー文の固有値: {9, 19, 20, 21, 22} (5種類)
- 全体の固有値: {1, 2, 5, 6, 7, 8, 9, 13, 16, 17, 19, 20, 21, 22, 23, 24} (16種類)
- 使われていない値: 3, 4, 10, 11, 12, 14, 15, 18
- 値の範囲: 1〜24

### 頻度分析（質問文）
- 8: 9回（最頻出 → 区切り文字/スペース？）
- 19: 5回
- 22: 5回
- 5: 4回
- 6: 3回
- 17: 3回
- 1: 3回
- 16: 1回
- 20: 1回
- 21: 1回
- 24: 1回
- 23: 1回
- 13: 1回
- 2: 1回
- 7: 1回

### 8をスペースと仮定した場合の分割
```
2 | 16,5,6,20,6,19 | 22 | 19,22,21 | 24,22,23 | 19,17,1 | 7,5,17,1,22,5 | 19,6,13
```
→ 1文字, 6文字, 1文字, 3文字, 3文字, 3文字, 6文字, 3文字
→ 日本語なら「X XXXXXX X XXX XXX XXX XXXXXX XXX」

## 試したマッピング（全て失敗）

### 五十音順（1始まり: 1=あ, 2=い, ..., 24=ね）
- 質問: いくたおかとかてくにくてになくねにぬくてちあくきおちあにおくてかす
- エラー: てとにけな
- 日本語として意味が通らない

### 五十音順（0始まり: 0=あ, 1=い, ..., 23=ね）
- 質問: うけちかきなきてけにけてにはけねにぬけてつあけくかつあにかけてきせ
- エラー: ときぬこに
- 日本語として意味が通らない

### いろは順（1=い, 2=ろ, ..., 24=う）
- 質問: ろちたほへねへつちらちつらなちうらむちつれいちとほれいらほちつへわ
- エラー: つねらりな
- 日本語として意味が通らない

### アルファベット（A=1, B=2, ...）
- 質問: BHPEFTFSHVHSVUHXVWHSQAHGEQAVEHSFM
- エラー: STWIU
- 英語として意味が通らない

## ヒントからの情報
- GMヒント(hint-new.md)より:「鍵が間違っていたら「間違い」を出力して終了」
- エラーメッセージ（5文字）= 「間違い」か類似の語のはず
  - まちがい = 4文字 → 5文字に足りない（末尾に改行等？）
  - ちがいます = 5文字 → 可能性あり
  - はずれです = 5文字 → 可能性あり
  - ふせいかい = 5文字 → 可能性あり

## エラー文からの逆引き試行
エラー文: 19, 20, 22, 9, 21

### 「ちがいます」の場合
ち=19, が=20, い=22, ま=9, す=21
→ 濁音「が」が単独コードを持つ → 五十音順とは異なる体系

### 「はずれです」の場合
は=19, ず=20, れ=22, で=9, す=21
→ 濁音「ず」「で」が単独コード

### 「ふせいかい」の場合
ふ=19, せ=20, い=22, か=9, い=21
→ 「い」が22と21で2つの値 → 矛盾、この候補は除外

## 次のアプローチ案
1. **codexに聞く**: 暗号解析・文字コード推定の得意なAIに相談
2. **サーバーで実験**: https://stars-2026-hp.xyz/ でプログラムの動作を確認
3. **プログラム内部解析**: SKI式の鍵チェック部分を逆解析して文字テーブルを特定
4. **エラー文の候補を絞る**: 5文字の日本語で「間違い」を意味する語を全列挙し、文字コードの整合性を検証
