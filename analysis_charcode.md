# 文字コード解析メモ

## 状況
stars.txtのSKIプログラムを評価すると、I/Oプロトコルで質問文を出力→鍵文字列を入力→正誤判定を行う。
文字列の取り出しに成功し、各文字のコード（整数値）を取得できた。
コードは1-24の範囲。文字との対応を解読中。

## I/Oフロー（確認済み）
1. 出力(文字列): 33文字の質問文
2. 入力(文字列): 鍵文字列の入力要求
3. 出力(文字列): 5文字のメッセージ（空入力→不正解メッセージ = "wrong"）
4. 停止

## 外部情報（他プレイヤー等から取得）

### ★重要★ 「M5PWz」= 「wrong」の対応関係
**「M5PWz」は「wrong」のエンコード表現**（文字コード変換の対応）
つまり、プログラムの文字コードと実際の文字の対応:
```
プログラム内部コード → 表示文字 → 実際の意味（英語）
19 → M → w
20 → 5 → r
22 → P → o
 9 → W → n
21 → z → g
```
※ これはエラーメッセージ（5文字: コード 19,20,22,9,21）が "wrong"(英語) であることを示す
※ 表示文字（M, 5, P, W, z）は**サーバー上で使われる文字セット**

### 整数0-24のコンパクトSKI表現（別の記法）
```
Dlu      0
Xn&      1
PXz      2
n9u      3
zPQ      4
uPX      5
uPXn&    6
uPXPXz   7
uPXn9u   8
uPXzlQ   9
wn-      10
wn-Xn&   11
wn-PXz   12
wn-n9u   13
wn-zPQ   14
wn-uPX   15
wn-uPXn& 16
wn-uPXPXz    17
wn-uPXn9u    18
wn-uPXzlQ   19
PXzn-wn-     20
PXzn-wn-Xn&  21
PXzn-wn-PXz  22
PXzn-wn-n9u  23
PXzn-wn-zPQ  24
```

#### この表の構造パターン
- 0-4: 3文字の基本表現 (Dlu, Xn&, PXz, n9u, zPQ)
- 5-9: "uPX" + 基本表現(0-4からの派生)
- 10-19: "wn-" + 0-9の表現
- 20-24: "PXzn-wn-" + 0-4の表現
- **5進法ベースの構造**に見える

## 取得した文字コード

### 質問文（33文字、読み順）
```
2, 8, 16, 5, 6, 20, 6, 19, 8, 22, 8, 19, 22, 21, 8, 24, 22, 23, 8, 19, 17, 1, 8, 7, 5, 17, 1, 22, 5, 8, 19, 6, 13
```

### エラーメッセージ（5文字、読み順）→ "wrong"
```
19(=w), 20(=r), 22(=o), 9(=n), 21(=g)
```

## 頻度分析（質問文）

### 全体
```
コード: 出現回数
  8  :    7    （最頻出 → スペース?）
 19  :    5    = w
 22  :    5    = o
  5  :    3
  6  :    3
 17  :    2
  1  :    2
 16  :    1
 20  :    1    = r
 21  :    1    = g
 24  :    1
 23  :    1
 13  :    1
  2  :    1
  7  :    1
```

### 8をスペースと仮定した場合の分割（7スペース→8単語）
```
2 | 16,5,6,r,6,w | o | w,o,g | 24,o,23 | w,17,1 | 7,5,17,1,o,5 | w,6,13
```
→ 単語長: 1-6-1-3-3-3-6-3
→ パターン: "? ???r?w o wog ?o? w?? ????o? w??"

### 課題
- w=19が質問文中5回 → 英語の'w'は通常2.4%で、20.8%は異常に高い
- "wog"（word 4）は一般的な英語単語ではない
- 8=スペースの仮定、またはwrong対応そのものの再検証が必要かも

## 確定情報まとめ

### 確定した文字対応（5文字）
| コード | 表示文字 | 意味(英語) |
|--------|----------|------------|
| 9      | W        | n          |
| 19     | M        | w          |
| 20     | 5        | r          |
| 21     | z        | g          |
| 22     | P        | o          |

### 未確定コード（11個）
1, 2, 5, 6, 7, 8, 13, 16, 17, 23, 24

### 全く使われていないコード（8個）
3, 4, 10, 11, 12, 14, 15, 18

## 次のアプローチ案

1. **タイミングサイドチャネル攻撃**: SKI評価器のQ(λ)に各文字コード(1-24)を1文字ずつ試し、ステップ数の差で正しい鍵文字を特定
2. **サーバー実験**: 他の文字を試してcode→表示文字の対応を増やす
3. **質問文パターン解析**: 英語の語彙パターンから残り11コードを推定
4. **コンパクト表の記法解読**: 我々のk/X/D/-記法との対応を解明して数値エンコーディングを検証
