# Stars 2026 HP - 全体分析

## 1. これは何か

「あんたがた2026HP」の謎解き。独自のプログラミング言語（カスタムエンコーディング）を使った問題群と、
最終課題である `stars.txt`（約400MB）の解読が目標。

サーバー: `https://stars-2026-hp.xyz/` にPOSTでコマンドを送る。

## 2. 問題構成

### Q-series（プログラム章）: Q.0 〜 Q.10 → **全問解決済み**
| 問題 | テーマ | 答え | 状態 |
|------|--------|------|------|
| Q.0 | print, format | 2 (PXz) | 解決 |
| Q.1 | コード評価・簡約規則 | 3 (n9u) | 解決 |
| Q.2 | 算術演算 (add/subtract/multiply) | 9 (uPXzlQ) | 解決 |
| Q.3 | 条件分岐 (if/equals/greater) | 4 (zPQ) | 解決 |
| Q.4 | 関数定義 (function/call) | 絶対値関数 | 解決 |
| Q.5 | 再帰 (recursive) | べき乗関数 | 解決 |
| Q.6 | 配列 (array/input) | 降順ソート | 解決 |
| Q.7 | リスト (push/pop/fold) | リスト合計 | 解決 |
| Q.8 | 文字列/シンボル (strings as lists) | 文字列反転 | 解決 |
| Q.9 | format pipeline (substitute/output) | 文字列繰り返し | 解決 |
| Q.10 | 画像出力 (diamond構造) | 三角形パターン | 解決 |

### l-series（グラフ/木章）: l.0 〜 l.4 → **全問解決済み**
| 問題 | テーマ | 答え | 状態 |
|------|--------|------|------|
| l.0 | グラフ基礎 (postorder符号化) | `lll--ll--` | 解決 |
| l.1 | グラフ書き換え規則 | `ll-` | 解決 |
| l.2 | コンパクト符号化 (SKI) | `kkD-XXD----XXD---` | 解決 |
| l.3 | SKIでのデータエンコード | 数字3のコンパクト符号 | 解決 |
| l.4 | bracket abstraction | 関数コード→SKI変換 | 解決 |

### stars.txt（最終課題）: **未解決 — これが残りの謎**

## 3. stars.txt の現状

### わかっていること
- サイズ: 419,677,398バイト
- 内容: `l` (209,838,699個) と `-` (209,838,698個) のみ
- leaves - dashes = 1 → 有効な単一二分木
- SKIコンパクト圧縮済み → `stars_compact.txt` (30,485,221文字, k/D/X/-のみ)

### トップレベル構造
```
(LEFT RIGHT)
├── LEFT (~152K文字): 上位適用器 ((S X)(K Y))
│   ├── X: 61,418文字 — RIGHTに適用される関数の一部
│   └── Y: 90,513文字 — RIGHTに適用される関数の一部
│   ※ LEFT(RIGHT) = X RIGHT Y として展開される
│
└── RIGHT (~30.3M文字): ((B^6 H) DATA_CHAIN)
    ├── B^6 composition tower — 関数合成の多段適用
    ├── H: ~30M文字 — メインプログラム（デコーダー）
    └── DATA_CHAIN: 307,125文字 (25アイテム) — データ（画像データ含む）
```
**注意**: デコーダープログラムはRIGHT内のH。LEFTは上位の適用器であり、
`(LEFT RIGHT)` の評価で `X RIGHT Y` が得られ、さらにRIGHT内部で
`H` が `DATA_CHAIN` を処理する。

### DATA_CHAIN (25アイテム) の一部デコード
- アイテム2: 33個の数値リスト [13, 6, 19, 8, 5, 22, 1, 17, 5, 7, 8, 1, 17, 19, 8, 23, 22, 24, 8, 21, 22, 19, 8, 22, 8, 19, 6, 20, 6, 5, 16, 8, 2]
- アイテム9: 301,617文字の再帰的自己相似構造 (26レベル深)
- アイテム19: 5個の数値リスト [21, 9, 22, 20, 19]
- アイテム21: 数値 0

### 未解決の部分
1. **文字マッピング**: 数値列→テキストの変換方法が不明
2. **アイテム9の完全デコード**: 301K文字の再帰構造が未完了
3. **デコーダー部（H, ~30M文字）のラムダ式変換と理解**: 未完了
4. **最終的な答えのフォーマット**: 不明

## 4. GMヒントのまとめ

### ヒント(旧)
1. l章で説明している変換は「bracket abstraction」（λ式→SKIコンビネータ式）
2. 逆変換が可能（SKI→λ式に戻せる）
3. 以下がどうλ式に変換されるか調べよ:
   - 真偽値、列(スタック)、整数(チャーチエンコーディングではない!)、再帰、画像出力の5引数記号
4. スターグラフは関係ない
5. データ部は画像データ。暗号化されているのでデコード部の復元が必要
6. 演算子の木と見比べてデコード部を復元せよ

### ヒント(新) - bracket abstraction詳細
- convert/bracket/revertの具体的アルゴリズムが提示
- SKI→λ式の逆変換手順が明示
- 整数はScottエンコーディング（チャーチではない）

### 解法方針（GMが示唆）
**方針A**: λ式→元のプログラムコードに復元→プログラムを読解して解く
**方針B**: λ式のままインタプリタを作り、stars.txtを実行する

## 5. しゅがさとの解法ステップ

1. 情報収集
2. コード作成（3つ）:
   - `l`/`-` → `k`/`D`/`X`/`-` に変換
   - `k`/`D`/`X`/`-` → `S`/`K`/`I`/`(`/`)` に変換
   - `S`/`K`/`I` → ラムダ式に変換
3. デコードとデータの分離
4. デコード部のラムダ式化
5. データ部の変換（画像データ: 4096ごとに改行、黒=1/白=0）
